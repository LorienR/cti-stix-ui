<div class="container">
{{help-card help=model.help}}
<h4>
  <img class='stix-icon' src='{{get-stix-icon-url "attack-pattern"}}'>
  Attack Pattern
</h4>

<div class="row">
  {{md-input label="Name"
            class="md-input-focused"
           value=model.item.name
           required=true
           validate=true
           class="col s12"}}
</div>

<div class="row">
  {{md-textarea label="Description"
                value=model.item.description
                class="col s12"}}
</div>

<h5>Kill Chain Phases</h5>

<div class="row">
  <div class="col s1">
    {{md-btn text="Add" action="addKillChainPhase" actionArg=model.item}}
  </div>
</div>

{{#each model.item.kill_chain_phases as |killChainPhase|}}

  {{#md-card title=killChainPhase.kill_chain_name}}
    {{#md-card-content}}
      <div class="row">
        {{md-input label="Kill Chain Name"
                   value=killChainPhase.kill_chain_name
                   validate=true
                   class="col s6"}}
        {{md-input label="Phase Name"
                   value=killChainPhase.phase_name
                   validate=true
                   class="col s6"}}
      </div>
    {{/md-card-content}}
    {{#md-card-action}}
      {{md-btn text="Remove" action="removeKillChainPhase" actionArg=killChainPhase}}
    {{/md-card-action}}
  {{/md-card}}

{{/each}}

<h5>External References</h5>

<div class="row">
  <div class="col s1">
    {{md-btn text="Add" action="addExternalReference" actionArg=model.item}}
  </div>
</div>

{{#each model.item.external_references as |externalReference|}}

  {{#md-card title=externalReference.external_id}}
    {{#md-card-content}}
      <div class="row">
        {{md-input label="External ID"
                   value=externalReference.external_id
                   validate=true
                   class="col s2"}}
        {{md-input label="Source Name"
                   value=externalReference.source_name
                   validate=true
                   class="col s4"}}
        {{md-input label="URL"
                   value=externalReference.url
                   validate=true
                   class="col s6"}}
      </div>
    {{/md-card-content}}
    {{#md-card-action}}
      {{md-btn text="Remove" action="removeExternalReference" actionArg=externalReference}}
    {{/md-card-action}}
  {{/md-card}}

{{/each}}

  <div class="row">  
    <div class="col s12 right-align">
      <div class="option-button-column-right">
        <button {{action "save" model.item false}} class="btn waves-effect waves-light"><i class="fa fa-save"></i><span class="fa-button-text">Save &amp; Close</span></button>
      </div>
      <div class="option-button-column-right">
        {{#link-to "attack-patterns" title="Cancel" class="btn waves-effect waves-light"}}
          <i class="fa fa-arrow-left"></i><span class="fa-button-text">Cancel</span>
        {{/link-to}}
      </div>
    </div>
  </div>

  {{alert-card alert=model.alert}}

</div>